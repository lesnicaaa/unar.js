{"version":3,"sources":["..\\src\\Config\\index.js","..\\src\\View\\Attr\\index.js","..\\src\\View\\DomEvent\\index.js","..\\src\\Hub\\index.js","..\\src\\View\\Detective\\index.js","..\\src\\View\\index.js","..\\src\\Instance\\index.js","index.js"],"names":["config","actionPrefix","attrPrefix","evtPrefix","Attr","txt","test","attr","indexOf","PropPrefix","DomEvent","vm","node","val","value","text","textContent","html","innerHTML","attrName","attrVal","substr","length","evtName","fn","addEventListener","id","Hub","prop","cb","listeners","addListener","push","forEach","hubs","window","Detictive","_update","bind","methods","addEvt","detictive","Templater","selector","el","document","querySelector","appendChild","init","fragment","createDocumentFragment","filterNode2fragment","childNodes","initAttrEvt","console","log","i","nodeType","_isPureBlankNode","attributes","nodeName","nodeValue","isAction","isProp","isEvt","call","childNode","isExpression","data","Unar","o","$options","_data","Object","keys","defineProperty","key","configurable","enumerable","get","set","newVal","valCache","app","a"],"mappings":"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","file":"5b72c79f27ef43dd868834849ff2663e.map","sourcesContent":["//Unar.global={\r\n//     actionPrefix:\"u\",\r\n//     attrPrefix:\":\",\r\n//     evtPrefix:\"@\",\r\n// }\r\n\r\n//merge\r\nvar config = {\r\n    actionPrefix: \"u\",\r\n    attrPrefix: \":\",\r\n    evtPrefix: \"@\",\r\n}\r\nexport default config","import config from \"../../Config\"\r\nexport default class Attr {\r\n    static isExpression(txt) {\r\n        return /\\{\\{.*\\}\\}/.test(txt);\r\n    }\r\n    static isAction(attr) {\r\n        //u\r\n        return attr.indexOf(config.actionPrefix) === 0;\r\n    }\r\n    static isProp(attr) {\r\n        //: v-bind:a=\"a\"\r\n        return attr.indexOf(config.PropPrefix) === 0;\r\n    }\r\n    static isEvt(attr) {\r\n        //: v-bind:a=\"a\"\r\n        return attr.indexOf(config.evtPrefix) === 0;\r\n    }\r\n}","/**\r\n * DomEvent\r\n */\r\nexport default class DomEvent {\r\n    constructor(vm){\r\n        this.vm=vm\r\n    }\r\n    static model(node, val) {\r\n        node.value = val;\r\n    }\r\n    static text(node, text) {\r\n        node.textContent = text;\r\n    }\r\n    static html(node, html) {\r\n        node.innerHTML = html;\r\n    }\r\n    static bind(node, attrName, attrVal) {\r\n        node[attrName.substr(config.attrPrefix.length, attrName.length)] = attrVal;\r\n    }\r\n    static addEvt(node, evtName, fn) {\r\n        debugger\r\n        node.addEventListener(evtName, fn, false)\r\n    }\r\n}","/**\r\n * one vm prop <---> one Hub\r\n */\r\nvar id = 0;\r\nexport default class Hub{\r\n    constructor(prop,cb){\r\n        this.id=++id;\r\n        this.prop=prop;\r\n        this.listeners=[]\r\n        this.addListener(cb)\r\n    }\r\n    addListener(cb){\r\n        this.listeners.push(cb)\r\n    }\r\n    deleteListener(){\r\n        \r\n    }\r\n    notify(){\r\n        this.listeners.forEach((fn)=>{\r\n            fn()\r\n        })\r\n    }\r\n}","/**\r\n * Detictive\r\n * 静态方法包含this关键字，这个this指的是类\r\n */\r\nimport config from \"../../Config\"\r\nimport DomFn from \"../DomEvent\"\r\nimport Hub from \"../../Hub\"\r\nvar hubs = [];\r\nwindow.hubs=hubs\r\nexport default class Detictive {\r\n    static[config.actionPrefix + \"-model\"](node, val) {\r\n        this._update(\"model\", node, val)\r\n    }\r\n    static[config.actionPrefix + \"-text\"](node, text) {\r\n        this._update(\"text\", node, text)\r\n    }\r\n    static[config.actionPrefix + \"-html\"](node, html) {\r\n        this._update(\"html\", node, html)\r\n    }\r\n    //:\r\n    static bind(node, attrName, attrVal) {\r\n        DomFn.bind(node, attrName, attrVal)\r\n    }\r\n    //@\r\n    static addEvt(node, attrName, fn) {\r\n        var evtName = attrName.substr(config.evtPrefix.length, attrName.length)\r\n        var fn = this.methods[fn].bind(this)\r\n        DomFn.addEvt(node, evtName, fn)\r\n    }\r\n    static _update(detictive, node, val) {\r\n        var cb = DomFn[detictive];\r\n        cb(node, val);\r\n        //检测hubs 是否具备此prop（value）hub，有的添加cb回调，没有创建便hub\r\n        hubs.push(new Hub(val, cb))\r\n    }\r\n}","/**\r\n * Templater\r\n */\r\nimport Attr from \"./Attr\"\r\nimport Detective from \"./Detective\"\r\n\r\nexport default class Templater {\r\n    constructor(selector, vm) {\r\n        this.vm = vm;\r\n        this.el = document.querySelector(selector);\r\n        if (this.el) {\r\n            this.el.appendChild(this.init());\r\n        }\r\n    }\r\n    init() {\r\n        const fragment = document.createDocumentFragment();\r\n        this.filterNode2fragment(fragment)\r\n        //初始化view\r\n        fragment.childNodes.forEach((node)=>{\r\n            this.initAttrEvt(node)\r\n        })\r\n        console.log(fragment)\r\n        // for (let node of fragment.childNodes) {\r\n        //     this.initAttrEvt(node)\r\n        // }\r\n        return fragment\r\n    }\r\n    filterNode2fragment(fragment){\r\n        //所有节点node\r\n        for (let i = 0; i < this.el.childNodes.length; i++) {\r\n            const node = this.el.childNodes[i];\r\n            const nodeType = node.nodeType;\r\n            //for reduce the loop count ,filter nodes to Element Comment Text(not contain pure whitespace)\r\n            if (nodeType === 1 || nodeType === 8 || (nodeType === 3) && !this._isPureBlankNode(node)) {\r\n                fragment.appendChild(node);\r\n                --i;\r\n            }\r\n        }\r\n    }\r\n    initAttrEvt(node) {\r\n        //排除元素、文本以外的节点\r\n        if (node.nodeType === 1) {\r\n            //node.attributes\r\n            for (let attr of node.attributes) {\r\n                //过滤掉非unar的动作、属性、事件\r\n                const attrName = attr.nodeName;\r\n                const attrVal = attr.nodeValue;\r\n                //u-html u-model\r\n                if (Attr.isAction(attrName)) {\r\n                    Detective[attrName](node, attrVal)\r\n                }\r\n                //:id\r\n                if (Attr.isProp(attrName)) {\r\n                    Detective.bind(node, attrName, attrVal)\r\n                }\r\n                //@click\r\n                if (Attr.isEvt(attrName)) {\r\n                    Detective.addEvt.call(this.vm,node, attrName, attrVal)\r\n                }\r\n            }\r\n            node.childNodes.forEach((childNode)=>{\r\n                this.initAttrEvt(childNode)\r\n            })\r\n        }\r\n        //text {{}}\r\n        if (node.nodeType === 3 && Attr.isExpression(node.data)) {\r\n        }\r\n       \r\n    }\r\n    /**\r\n     * https://developer.mozilla.org/zh-CN/docs/Web/Guide/API/DOM/Whitespace_in_the_DOM\r\n     * 以下所谓的“空白符”代表：\r\n     *  \"\\t\" TAB \\u0009 （制表符）\r\n     *  \"\\n\" LF  \\u000A （换行符）\r\n     *  \"\\r\" CR  \\u000D （回车符）\r\n     *  \" \"  SPC \\u0020 （真正的空格符）\r\n     *\r\n     * 不包括 JavaScript 的“\\s”，因为那代表如不断行字符等其他字符。\r\n     */\r\n    /**\r\n     * 测知某节点的文字内容是否全为空白。\r\n     *\r\n     * @参数   nod  |CharacterData| 类的节点（如  |Text|、|Comment| 或 |CDATASection|）。\r\n     * @传回值      若 |nod| 的文字内容全为空白则传回 true，否则传回 false。\r\n     */\r\n    _isPureBlankNode(node) {\r\n        // Use ECMA-262 Edition 3 String and RegExp features\r\n        return !(/[^\\t\\n\\r ]/.test(node.data));\r\n    }\r\n}","/**\r\n * Unar\r\n */\r\n\r\n \r\n// import util from \"../Util\"\r\n// import detective from \"./Detective\"\r\n// import model from \"./Model\"\r\nimport Templater from \"../View/index.js\"\r\n\r\nexport default class Unar {\r\n    /*options\r\n    methods{\r\n        fn1,\r\n        fn2\r\n    }\r\n    data{a:1,b:2}\r\n\r\n    a:1\r\n    b:2\r\n    fn1,\r\n    fn2\r\n    */\r\n    constructor(o) {\r\n        this.methods=o.methods;\r\n        this.$options = {};\r\n        //在vm新建_data、$options属性\r\n        var data = this._data = this.$options.data = o.data;\r\n\r\n        //创建代理（存取）属性，代理_data、$options对象下的存取属性\r\n        Object.keys(data).forEach(key => {\r\n            Object.defineProperty(this, key, {\r\n                configurable: false,\r\n                enumerable: true,\r\n                get: function () {\r\n                    //data[key]、this._data[key]、this.$options.data 、o.data都可以\r\n                    //实现代理对象（读写都要通过这个代理），然后访问this._data[key]、this.$options.data的存取器属性\r\n                    //此getter会调用下面getter\r\n                    return data[key];\r\n                },\r\n                set: function (newVal) {\r\n                    data[key] = newVal;\r\n                }\r\n            });\r\n            //使用闭包，存储这个值。（data[key],运行到此还是数据属性）\r\n            //data[key]、this._data[key]、this.$options.data 、o.data都可以\r\n            var valCache = data[key];\r\n\r\n            //data相当于同时，把this_data和this.$options.data,o.data三个都变成了存取器属性\r\n            Object.defineProperty(data, key, {\r\n                configurable: false,\r\n                enumerable: true,\r\n                get: function () {\r\n                    //可以尝试这个\r\n                    //this._data[key]，this.$options.data[key]和data[key]都会爆栈\r\n                    return valCache;\r\n                },\r\n                set: function (newVal) {\r\n                    valCache = newVal;\r\n                }\r\n            });\r\n        })\r\n        new Templater(o.el, this)\r\n    }\r\n    // static use() {}\r\n    // static extend() {}\r\n    // static $nextTick() {}\r\n    // $get() {\r\n    //     //utils.get(this, key, val)\r\n    // }\r\n    // $set() {\r\n    //     utils.set(this, key, val)\r\n    // }\r\n    // $created() {}\r\n    // $mounted() {}\r\n    // $watch() {}\r\n    // $computed() {}\r\n    // $remove() {}\r\n    // $destroy() {}\r\n    // $before() {}\r\n    // $after() {}\r\n    // 'emit', 'on', 'off', 'once'\r\n}","import Unar from \"../src/Instance/index.js\"\r\nconst app = new Unar({\r\n    el: \"#root\",\r\n    data: {\r\n        a: 1,\r\n        id: 'input1'\r\n    },\r\n    methods: {\r\n        fn() {\r\n            console.log(this.a)\r\n        }\r\n    }\r\n})\r\n// import {p} from \"./parcel.js\"\r\n// p.es6fn('like')\r\n"]}